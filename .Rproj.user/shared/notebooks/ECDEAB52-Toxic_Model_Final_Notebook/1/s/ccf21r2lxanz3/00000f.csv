"0","#Train Naive Bayes model"
"0","library(e1071)"
"0","naive_bayes_model <- naiveBayes(as.factor(label) ~ ., data = train_data)"
"0",""
"0","# Make predictions"
"0","naive_bayes_predictions <- predict(naive_bayes_model, newdata = test_data)"
"0",""
"0","# Calculate confusion matrix"
"0","naive_bayes_confusion_matrix <- confusionMatrix(naive_bayes_predictions, factor(test_data$label, levels = c(0, 1)))"
"0",""
"0","# Print confusion matrix"
"0","print(naive_bayes_confusion_matrix)"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","    0"
"1","    1"
"1","
         0"
"1","  137"
"1","   12"
"1","
         1"
"1"," 1827"
"1","  824"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.3432          "
"1","
"
"1","                 95% CI :"
"1"," (0.3256, 0.3611)"
"1","
"
"1","    No Information Rate :"
"1"," 0.7014          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 1               "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.0341          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," <2e-16          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.06976         "
"1","
"
"1","            Specificity :"
"1"," 0.98565         "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.91946         "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.31083         "
"1","
"
"1","             Prevalence :"
"1"," 0.70143         "
"1","
"
"1","         Detection Rate :"
"1"," 0.04893         "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.05321         "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.52770         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," 0               "
"1","
"
"1","                         "
"1","                 "
"1","
"
"0","# Extract metrics for Naive Bayes model"
"0","naive_bayes_precision <- naive_bayes_confusion_matrix$byClass[""Pos Pred Value""]"
"0","naive_bayes_recall <- naive_bayes_confusion_matrix$byClass[""Sensitivity""]"
"0","naive_bayes_f1_score <- naive_bayes_confusion_matrix$byClass[""F1""]"
"0","naive_bayes_accuracy <- naive_bayes_confusion_matrix$overall[""Accuracy""]"
"0","naive_bayes_specificity <- naive_bayes_confusion_matrix$byClass[""Specificity""]"
"0","naive_bayes_balanced_accuracy <- naive_bayes_confusion_matrix$byClass[""Balanced Accuracy""]"
"0","naive_bayes_kappa <- naive_bayes_confusion_matrix$overall[""Kappa""]"
"0",""
"0","# Print metrics for Naive Bayes model"
"0","cat(""Naive Bayes Metrics:\n"")"
"1","Naive Bayes Metrics:
"
"0","cat(""Precision:"", naive_bayes_precision, ""\n"")"
"1","Precision:"
"1"," "
"1","0.9194631"
"1"," "
"1","
"
"0","cat(""Recall:"", naive_bayes_recall, ""\n"")"
"1","Recall:"
"1"," "
"1","0.0697556"
"1"," "
"1","
"
"0","cat(""F1 Score:"", naive_bayes_f1_score, ""\n"")"
"1","F1 Score:"
"1"," "
"1","0.1296735"
"1"," "
"1","
"
"0","cat(""Accuracy:"", naive_bayes_accuracy, ""\n"")"
"1","Accuracy:"
"1"," "
"1","0.3432143"
"1"," "
"1","
"
"0","cat(""Specificity:"", naive_bayes_specificity, ""\n"")"
"1","Specificity:"
"1"," "
"1","0.9856459"
"1"," "
"1","
"
"0","cat(""Balanced Accuracy:"", naive_bayes_balanced_accuracy, ""\n"")"
"1","Balanced Accuracy:"
"1"," "
"1","0.5277008"
"1"," "
"1","
"
"0","cat(""Kappa:"", naive_bayes_kappa, ""\n"")"
"1","Kappa:"
"1"," "
"1","0.03412561"
"1"," "
"1","
"
